## Define the stages & order of execution

stages:
  - CLUSTER-SETUP
  - CSTOR-CSI-INFRA-SETUP
  - CSTOR-CSI-FUNCTIONAL
  - CSTOR-CSI-CHAOS
  - CSTOR-CSI-INFRA-CHAOS
  - OPENEBS-CLEANUP
  - CLUSTER-CLEANUP
  
##########################################################################################

PCZD-OpenShift:
  image: openebs/openshift-ci:latest
  stage: CLUSTER-SETUP
  script:     
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/1-cluster-setup/PCZD-cluster-setup/cluster-state
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/1-cluster-setup/PCZD-cluster-setup/cluster-state

.csi_infra_test_template:
  image: openebs/openshift-ci:latest
  stage: CSTOR-CSI-INFRA-SETUP
  when: always

AAO9-CSTOR-OPERATOR:
  extends: .csi_infra_test_template        
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/2-csi-infra-setup/AAO9-cstor-operator/cstor-operator
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/2-csi-infra-setup/AAO9-cstor-operator/cstor-operator
  
2UVA-CSPC-MIRROR-POOL:
  extends: .csi_infra_test_template        
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/2-csi-infra-setup/2UVA-create-cspc-mirror-pool/create-cspc-mirror-pool
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/2-csi-infra-setup/2UVA-create-cspc-mirror-pool/create-cspc-mirror-pool

GRLZ-CSPC-STRIPE-POOL:
  extends: .csi_infra_test_template        
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/2-csi-infra-setup/GRLZ-create-cspc-stripe-pool/create-cspc-stripe-pool
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/2-csi-infra-setup/GRLZ-create-cspc-stripe-pool/create-cspc-stripe-pool

RZ25-csi-storage-policies:
  extends: .csi_infra_test_template
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/2-csi-infra-setup/RZ25-csi-storage-policies/openebs-csi-sc
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/2-csi-infra-setup/RZ25-csi-storage-policies/openebs-csi-sc  

#########################################################################################

.csi_func_test_template:
  image: openebs/openshift-ci:latest
  stage: CSTOR-CSI-FUNCTIONAL
  when: always

19WS-CSI-CSTOR-CLONE:
  extends: .csi_func_test_template        
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/19WS-csi-cstor-clone/csi-cstor-clone
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/19WS-csi-cstor-clone/csi-cstor-clone

BPUC-CSI-VOLUME-RESIZE-XFS:
  extends: .csi_func_test_template        
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/BPUC-csi-volume-resize-xfs/csi-volume-resize-xfs
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/BPUC-csi-volume-resize-xfs/csi-volume-resize-xfs

CGCH-CSTOR-CSPC-POOL-SCALEUP:
  extends: .csi_func_test_template        
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/CGCH-cstor-cspc-pool-scaleup/cstor-cspc-pool-scaleup
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/CGCH-cstor-cspc-pool-scaleup/cstor-cspc-pool-scaleup

EUI0-CSI-VOLUME-RESIZE:
  extends: .csi_func_test_template        
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/EUI0-csi-volume-resize/csi-volume-resize
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/EUI0-csi-volume-resize/csi-volume-resize

F4DE-CSTOR-CSPC-POOL-EXPANSION:
  extends: .csi_func_test_template        
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/F4DE-cstor-cspc-pool-expansion/cstor-cspc-pool-expansion
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/F4DE-cstor-cspc-pool-expansion/cstor-cspc-pool-expansion
        
IEZ4-CSTOR-CSPC-POOL-REPLACE-BLOCKDEVICE:
  extends: .csi_func_test_template        
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/IEZ4-cstor-cspc-pool-replace-blockdevice/cstor-cspc-pool-replace-blockdevice
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/IEZ4-cstor-cspc-pool-replace-blockdevice/cstor-cspc-pool-replace-blockdevice

S4B4-CSI-CSTOR-SNAPSHOT:
  extends: .csi_func_test_template        
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/S4B4-csi-cstor-snapshot/csi-cstor-snapshot
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/S4B4-csi-cstor-snapshot/csi-cstor-snapshot

4H27-Backup-Restore-Diff-Profile:
  extends: .csi_func_test_template
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/4H27-Backup-Restore-Diff-Profile/backup-restore-diff-profile
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/4H27-Backup-Restore-Diff-Profile/backup-restore-diff-profile

8JM3-Backup-Restore-Cstor:
  extends: .csi_func_test_template
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/8JM3-Backup-Restore-Cstor/backup-restore-cstor-csi
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/8JM3-Backup-Restore-Cstor/backup-restore-cstor-csi

TUZX-Local-Backup-Restore:
  extends: .csi_func_test_template
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/TUZX-Local-Backup-Restore/local-backup-restore
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/TUZX-Local-Backup-Restore/local-backup-restore    

8NQ5-csi-volume-scaledown:
  extends: .csi_func_test_template
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/8NQ5-csi-volume-scaledown/csi-volume-scaledown
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/8NQ5-csi-volume-scaledown/csi-volume-scaledown

GQYO-pool-creation-with-claimed-bd:
  extends: .csi_func_test_template
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/GQYO-block-pool-creation-with-claimed-bd/block-pool-creation-with-claimed-bd
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/GQYO-block-pool-creation-with-claimed-bd/block-pool-creation-with-claimed-bd

OT3A-csi-volume-scaleup:
  extends: .csi_func_test_template
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/OT3A-csi-volume-scaleup/csi-volume-scaleup
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/OT3A-csi-volume-scaleup/csi-volume-scaleup

XSZG-pool-deletion-with-volume:
  extends: .csi_func_test_template
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/XSZG-block-pool-deletion-with-volume/block-pool-deletion-with-volume
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/XSZG-block-pool-deletion-with-volume/block-pool-deletion-with-volume

Y0IW-Remote-Restore-Diff-ns:
  extends: .csi_func_test_template
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/Y0IW-Remote-Restore-Diff-ns/remote-restore-diff-ns
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/3-csi-functional/Y0IW-Remote-Restore-Diff-ns/remote-restore-diff-ns

# ##########################################################################################

.csi_chaos_test_template:
  image: openebs/openshift-ci:latest
  stage: CSTOR-CSI-CHAOS
  when: always

5NV4-CSTOR-APP-KILL:
  extends: .csi_chaos_test_template        
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/4-csi-chaos/5NV4-cstor-app-kill/cstor-app-kill
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/4-csi-chaos/5NV4-cstor-app-kill/cstor-app-kill
    
8DJC-CSTOR-TARGET-KILL:
  extends: .csi_chaos_test_template        
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/4-csi-chaos/8DJC-cstor-target-kill/cstor-target-kill
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/4-csi-chaos/8DJC-cstor-target-kill/cstor-target-kill

D3L0-TARGET-NETWORK-LOSS:
  extends: .csi_chaos_test_template        
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/4-csi-chaos/D3L0-target-network-loss/target-network-loss
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/4-csi-chaos/D3L0-target-network-loss/target-network-loss

LJIJ-CSPC-CSTOR-POOL-KILL:
  extends: .csi_chaos_test_template
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/4-csi-chaos/LJIJ-cspc-cstor-pool-kill/cspc-cstor-pool-kill
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/4-csi-chaos/LJIJ-cspc-cstor-pool-kill/cspc-cstor-pool-kill

OEXN-CSTOR-TARGET-NETWORK-DELAY:
  extends: .csi_chaos_test_template
  script:
    - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/4-csi-chaos/OEXN-cstor-target-network-delay/target-network-delay
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/4-csi-chaos/OEXN-cstor-target-network-delay/target-network-delay

# ##########################################################################################

# .csi_infra_chaos_test_template:
#   image: openebs/openshift-ci:latest
#   stage: CSTOR-CSI-INFRA-CHAOS
#   when: always
#   dependencies:
#     - K9YC-OpenEBS

# WJ8S-NODE-FAILURE-CSI-CSTOR:
#   extends: .csi_infra_chaos_test_template
#   script:
#     - chmod 755 ./Openshift-EE/pipelines/OpenEBS-base/stages/10-csi-infra-chaos/WJ8S-node-failure-csi-cstor/node-failure-csi-cstor
#     - ./Openshift-EE/pipelines/OpenEBS-base/stages/10-csi-infra-chaos/WJ8S-node-failure-csi-cstor/node-failure-csi-cstor

.cleanup_test_template:
  image: openebs/openshift-ci:latest
  stage: OPENEBS-CLEANUP
  when: always

RZTG-cleanup-cstor-operator:
  extends: .cleanup_test_template
  script:
    - chmod 775 ./Openshift-EE/pipelines/OpenEBS-base/stages/6-cleanup/RZTG-cleanup-cstor-operator/cleanup-cstor-operator
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/6-cleanup/RZTG-cleanup-cstor-operator/cleanup-cstor-operator
    
XC0I-cleanup-cspc-striped-pool:
  extends: .cleanup_test_template
  script:
    - chmod 775 ./Openshift-EE/pipelines/OpenEBS-base/stages/6-cleanup/XC0I-cleanup-cspc-striped-pool/cleanup-cspc-striped-pool
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/6-cleanup/XC0I-cleanup-cspc-striped-pool/cleanup-cspc-striped-pool
    
KWD0-cleanup-cspc-mirrored-pool:
  extends: .cleanup_test_template
  script:
    - chmod 775 ./Openshift-EE/pipelines/OpenEBS-base/stages/6-cleanup/KWD0-cleanup-cspc-mirrored-pool/cleanup-cspc-mirrored-pool
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/6-cleanup/KWD0-cleanup-cspc-mirrored-pool/cleanup-cspc-mirrored-pool                 

4SMQ-cluster-Delete:
  image: openebs/openshift-ci:latest
  stage: CLUSTER-CLEANUP
  when: always
  dependencies:
    - PCZD-OpenShift
  script:
    - chmod 775 ./Openshift-EE/pipelines/OpenEBS-base/stages/6-cleanup/4SMQ-cluster-cleanup/cluster-cleanup
    - ./Openshift-EE/pipelines/OpenEBS-base/stages/6-cleanup/4SMQ-cluster-cleanup/cluster-cleanup
