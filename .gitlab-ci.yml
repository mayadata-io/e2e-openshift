## Define the stages & order of execution

stages:
  - CLUSTER-SETUP
  - OPENEBS-SETUP
  - FUNCTIONAL
  - CHAOS
  - CLEANUP

C538-OpenShift-3.10:
  image: openebs/openshift-ci:latest
  stage: CLUSTER-SETUP
  script:     
    - chmod 755 ./Openshift-EE/pipelines/Cassandra/stages/1-cluster-setup/C538-cluster-state/cluster-state
    - ./Openshift-EE/pipelines/Cassandra/stages/1-cluster-setup/C538-cluster-state/cluster-state

SKLV-OpenEBS:
  image: openebs/openshift-ci:latest
  stage: OPENEBS-SETUP
  script:
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/2-setup/SKLV-openebs-deploy/deploy-openebs
    - ./Openshift-EE/pipelines/Cassandra/stages/2-setup/SKLV-openebs-deploy/deploy-openebs

HNN7-OpenEBS-POLICIES:
  image: openebs/openshift-ci:latest
  stage: OPENEBS-SETUP
  script:
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/2-setup/HNN7-storage-policies/openebs-sc
    - ./Openshift-EE/pipelines/Cassandra/stages/2-setup/HNN7-storage-policies/openebs-sc
  
OJEF-CSTOR-POOL:
  image: openebs/openshift-ci:latest
  stage: OPENEBS-SETUP
  script:
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/2-setup/OJEF-create-striped-pool/create-pool
    - ./Openshift-EE/pipelines/Cassandra/stages/2-setup/OJEF-create-striped-pool/create-pool
    
.func_test_template:
  image: openebs/openshift-ci:latest
  stage: FUNCTIONAL
  when: always
  dependencies:
    - SKLV-OpenEBS
     
FRYG-Cassandra-Provision-cStor:
  extends: .func_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/3-functional/FRYG-deploy-cassandra-cstor/cassandra-deploy-cstor
    - ./Openshift-EE/pipelines/Cassandra/stages/3-functional/FRYG-deploy-cassandra-cstor/cassandra-deploy-cstor

EPAR-Cassandra-Provision-jiva:
  extends: .func_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/3-functional/EPAR-deploy-cassandra-jiva/deploy-cassandra-jiva
    - ./Openshift-EE/pipelines/Cassandra/stages/3-functional/EPAR-deploy-cassandra-jiva/deploy-cassandra-jiva

XONK-Cassandra-stress:
  extends: .func_test_template
  script:
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/3-functional/XONK-cassandra-loadgen/cassandra-loadgen
    - ./Openshift-EE/pipelines/Cassandra/stages/3-functional/XONK-cassandra-loadgen/cassandra-loadgen

DF5Q-cassandra-scaleup:
  extends: .func_test_template
  script:
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/3-functional/DF5Q-cassandra-scaleup/cassandra-scaleup
    - ./Openshift-EE/pipelines/Cassandra/stages/3-functional/DF5Q-cassandra-scaleup/cassandra-scaleup

.chaos_test_template:
  image: openebs/openshift-ci:latest
  stage: CHAOS
  when: always
  dependencies:
    - SKLV-OpenEBS

RJKZ-App-pod-kill:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/RJKZ-cassandra-pod-failure/app-pod-failure
    - ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/RJKZ-cassandra-pod-failure/app-pod-failure

78JT-cstor-target-kill:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/78JT-cstor-target-kill/cstor-target-kill
    - ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/78JT-cstor-target-kill/cstor-target-kill

NGGB-cstor-pool-kill:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/NGGB-cstor-pool-kill/cstor-pool-kill
    - ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/NGGB-cstor-pool-kill/cstor-pool-kill

Q3ZJ-cstor-pool-delete:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/Q3ZJ-cstor-pool-delete/cstor-pool-delete
    - ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/Q3ZJ-cstor-pool-delete/cstor-pool-delete

OI4T-cstor-target-network-delay:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/OI4T-cstor-target-network-delay/cstor-target-network-delay
    - ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/OI4T-cstor-target-network-delay/cstor-target-network-delay

IVQO-cstor-target-network-loss:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/IVQO-cstor-target-network-loss/cstor-target-network-loss
    - ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/IVQO-cstor-target-network-loss/cstor-target-network-loss

ADXV-cstor-volume-mgmt-kill:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/ADXV-cstor-volume-mgmt-kill/cstor-volume-mgmt-kill
    - ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/ADXV-cstor-volume-mgmt-kill/cstor-volume-mgmt-kill

7WXC-cstor-volume-istgt-kill:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/7WXC-cstor-volume-istgt-kill/cstor-volume-istgt-kill
    - ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/7WXC-cstor-volume-istgt-kill/cstor-volume-istgt-kill

M0NH-jiva-app-kill:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/M0NH-jiva-app-kill/jiva-app-kill
    - ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/M0NH-jiva-app-kill/jiva-app-kill

W2TE-jiva-replica-failure:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/W2TE-jiva-replica-failure/jiva-replica-failure
    - ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/W2TE-jiva-replica-failure/jiva-replica-failure

W831-jiva-replica-network-delay:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/W831-jiva-replica-network-delay/jiva-replica-network-delay
    - ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/W831-jiva-replica-network-delay/jiva-replica-network-delay

3Y70-jiva-controller-kill:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/3Y70-jiva-controller-kill/jiva-controller-kill
    - ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/3Y70-jiva-controller-kill/jiva-controller-kill

S193-jiva-controller-network-delay:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/S193-jiva-controller-network-delay/jiva-controller-network-delay
    - ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/S193-jiva-controller-network-delay/jiva-controller-network-delay

99H0-jiva-replica-node-affinity:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/99H0-jiva-replica-node-affinity/jiva-replica-node-affinity
    - ./Openshift-EE/pipelines/Cassandra/stages/4-chaos/99H0-jiva-replica-node-affinity/jiva-replica-node-affinity

WWDM-deprovision-cassandra-cstor:
  image: openebs/openshift-ci:latest
  stage: CLEANUP
  when: always
  script:
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/5-cleanup/WWDM-cassandra-cstor-cleanup/delete-cassandra-cstor
    - ./Openshift-EE/pipelines/Cassandra/stages/5-cleanup/WWDM-cassandra-cstor-cleanup/delete-cassandra-cstor
 
5N53-deprovision-cassandra-jiva:
  image: openebs/openshift-ci:latest
  stage: CLEANUP
  when: always
  script:
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/5-cleanup/5N53-cassandra-jiva-cleanup/delete-cassandra-jiva
    - ./Openshift-EE/pipelines/Cassandra/stages/5-cleanup/5N53-cassandra-jiva-cleanup/delete-cassandra-jiva
  
M14G-cluster-Delete:
  image: openebs/openshift-ci:latest
  stage: CLEANUP
  when: always
  dependencies:
    - C538-OpenShift-3.10
  script:
    - chmod 775 ./Openshift-EE/pipelines/Cassandra/stages/5-cleanup/M14G-cluster-cleanup/cluster-cleanup
    - ./Openshift-EE/pipelines/Cassandra/stages/5-cleanup/M14G-cluster-cleanup/cluster-cleanup
