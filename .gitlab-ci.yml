## Define the stages & order of execution

stages:
  - CLUSTER-SETUP
  - OPENEBS-SETUP
  - FUNCTIONAL
  - CHAOS
  - OPENEBS-CLEANUP
  - CLUSTER-CLEANUP
  
##########################################################################################

1LS01-CLUSTER-SETUP:
  image: openebs/openshift-ci:latest
  stage: CLUSTER-SETUP 
  script:     
    - chmod 755 ./openebs-openshift-e2e/pipelines/stages/1-cluster-setup/1LS01-cluster-setup/cluster-state
    - ./openebs-openshift-e2e/pipelines/stages/1-cluster-setup/1LS01-cluster-setup/cluster-state

##########################################################################################

2LP01-OPENEBS-DEPLOY:
  image: openebs/openshift-ci:latest
  stage: OPENEBS-SETUP 
  script:
    - chmod 775 ./openebs-openshift-e2e/pipelines/stages/2-setup/2LP01-openebs-deploy/openebs-deploy
    - ./openebs-openshift-e2e/pipelines/stages/2-setup/2LP01-openebs-deploy/openebs-deploy

##########################################################################################

.func_test_template:
  image: openebs/openshift-ci:latest
  stage: FUNCTIONAL 
  when: always
  dependencies:
    - 2LP01-OPENEBS-DEPLOY
     
3LF01-LOCALPV-ON-SELECTED-DEVICE:
  extends: .func_test_template
  script: 
    - chmod 775 ./openebs-openshift-e2e/pipelines/stages/3-functional/3LF01-Localpv-selected-device/openebs-localpv-device
    - ./openebs-openshift-e2e/pipelines/stages/3-functional/3LF01-Localpv-selected-device/openebs-localpv-device

3LF02-BACKUP-RESTORE-LOCALPV-DEVICE:
  extends: .func_test_template
  script: 
    - chmod 775 ./openebs-openshift-e2e/pipelines/stages/3-functional/3LF02-Backup-Restore-LocalPV-Device/backup-restore-localpv-device
    - ./openebs-openshift-e2e/pipelines/stages/3-functional/3LF02-Backup-Restore-LocalPV-Device/backup-restore-localpv-device

3LF03-BACKUP-RESTORE-LOCALPV-HOSTPATH:
  extends: .func_test_template
  script:
    - chmod 775 ./openebs-openshift-e2e/pipelines/stages/3-functional/3LF03-Backup-Restore-LocalPV/backup-restore-localpv
    - ./openebs-openshift-e2e/pipelines/stages/3-functional/3LF03-Backup-Restore-LocalPV/backup-restore-localpv

3LF04-Data-Integrity-Device:
  extends: .func_test_template
  script:
    - chmod 775 ./openebs-openshift-e2e/pipelines/stages/3-functional/3LF04-Data-Integrity-Device/data-integrity-device
    - ./openebs-openshift-e2e/pipelines/stages/3-functional/3LF04-Data-Integrity-Device/data-integrity-device

3LF05-Data-Integrity-Hostpath:
  extends: .func_test_template
  script:
    - chmod 775 ./openebs-openshift-e2e/pipelines/stages/3-functional/3LF05-Data-Integrity-Hostpath/data-integrity-hostpath
    - ./openebs-openshift-e2e/pipelines/stages/3-functional/3LF05-Data-Integrity-Hostpath/data-integrity-hostpath

##########################################################################################

.chaos_test_template:
  image: openebs/openshift-ci:latest
  stage: CHAOS 
  when: always
  dependencies:
    - 2LP01-OPENEBS-DEPLOY

4LC01-APP-KILL-LOCALPV-DEVICE:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./openebs-openshift-e2e/pipelines/stages/4-chaos/4LC01-localpv-device-app-kill/app-kill
    - ./openebs-openshift-e2e/pipelines/stages/4-chaos/4LC01-localpv-device-app-kill/app-kill

4LC02-APP-KILL-LOCALPV-HOSTPATH:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./openebs-openshift-e2e/pipelines/stages/4-chaos/4LC02-localpv-hostpath-app-kill/app-kill
    - ./openebs-openshift-e2e/pipelines/stages/4-chaos/4LC02-localpv-hostpath-app-kill/app-kill

##########################################################################################

.cleanup_test_template:
  image: openebs/openshift-ci:latest
  stage: OPENEBS-CLEANUP 
  when: always
  dependencies:
    - 2LP01-OPENEBS-DEPLOY
                
5LD01-OPENEBS-UNINSTALL:
  extends: .cleanup_test_template
  script:
    - chmod 775 ./openebs-openshift-e2e/pipelines/stages/5-cleanup/5LD01-openebs-cleanup/openebs-cleanup
    - ./openebs-openshift-e2e/pipelines/stages/5-cleanup/5LD01-openebs-cleanup/openebs-cleanup

##########################################################################################

5LD02-CLUSTER-DELETE:
  image: openebs/openshift-ci:latest
  stage: CLUSTER-CLEANUP
  when: always
  dependencies:
    - 1LS01-CLUSTER-SETUP
  script:
    - chmod 775 ./openebs-openshift-e2e/pipelines/stages/5-cleanup/5LD02-cluster-cleanup/cluster-cleanup
    - ./openebs-openshift-e2e/pipelines/stages/5-cleanup/5LD02-cluster-cleanup/cluster-cleanup
