## Define the stages & order of execution

stages:
  - CLUSTER-SETUP
  - OPENEBS-SETUP
  - FUNCTIONAL
  - CHAOS
  - CLEANUP

3OLN-OpenShift-3.10:
  image: openebs/openshift-ci:latest
  stage: CLUSTER-SETUP
  script:     
    - chmod 755 ./Openshift-EE/pipelines/mongodb/stages/1-cluster-setup/3OLN-cluster-state/cluster-state
    - ./Openshift-EE/pipelines/mongodb/stages/1-cluster-setup/3OLN-cluster-state/cluster-state

Y5YL-OpenEBS:
  image: openebs/openshift-ci:latest
  stage: OPENEBS-SETUP
  script:
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/2-setup/Y5YL-openebs-deploy/deploy-openebs
    - ./Openshift-EE/pipelines/mongodb/stages/2-setup/Y5YL-openebs-deploy/deploy-openebs

AWVX-OpenEBS-POLICIES:
  image: openebs/openshift-ci:latest
  stage: OPENEBS-SETUP
  script:
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/2-setup/AWVX-storage-policies/openebs-sc
    - ./Openshift-EE/pipelines/mongodb/stages/2-setup/AWVX-storage-policies/openebs-sc
  
6ZG4-CSTOR-POOL:
  image: openebs/openshift-ci:latest
  stage: OPENEBS-SETUP
  script:
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/2-setup/6ZG4-create-striped-pool/create-pool
    - ./Openshift-EE/pipelines/mongodb/stages/2-setup/6ZG4-create-striped-pool/create-pool
    
.func_test_template:
  image: openebs/openshift-ci:latest
  stage: FUNCTIONAL
  when: always
  dependencies:
    - Y5YL-OpenEBS
     
ZPRM-mongodb-Provision-cStor:
  extends: .func_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/3-functional/ZPRM-deploy-mongodb-cstor/mongodb-deploy-cstor
    - ./Openshift-EE/pipelines/mongodb/stages/3-functional/ZPRM-deploy-mongodb-cstor/mongodb-deploy-cstor

MI15-mongodb-Provision-jiva:
  extends: .func_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/3-functional/MI15-deploy-mongodb-jiva/deploy-mongodb-jiva
    - ./Openshift-EE/pipelines/mongodb/stages/3-functional/MI15-deploy-mongodb-jiva/deploy-mongodb-jiva

.chaos_test_template:
  image: openebs/openshift-ci:latest
  stage: CHAOS
  when: always
  dependencies:
    - Y5YL-OpenEBS

UQPC-App-pod-kill:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/4-chaos/UQPC-mongodb-pod-failure/app-pod-failure
    - ./Openshift-EE/pipelines/mongodb/stages/4-chaos/UQPC-mongodb-pod-failure/app-pod-failure

CX2A-cstor-target-kill:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/4-chaos/CX2A-cstor-target-kill/cstor-target-kill
    - ./Openshift-EE/pipelines/mongodb/stages/4-chaos/CX2A-cstor-target-kill/cstor-target-kill

2XFL-cstor-pool-kill:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/4-chaos/2XFL-cstor-pool-kill/cstor-pool-kill
    - ./Openshift-EE/pipelines/mongodb/stages/4-chaos/2XFL-cstor-pool-kill/cstor-pool-kill

K9ME-cstor-pool-delete:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/4-chaos/K9ME-cstor-pool-delete/cstor-pool-delete
    - ./Openshift-EE/pipelines/mongodb/stages/4-chaos/K9ME-cstor-pool-delete/cstor-pool-delete

W2HY-cstor-target-network-delay:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/4-chaos/W2HY-cstor-target-network-delay/cstor-target-network-delay
    - ./Openshift-EE/pipelines/mongodb/stages/4-chaos/W2HY-cstor-target-network-delay/cstor-target-network-delay

ZFIG-cstor-target-network-loss:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/4-chaos/ZFIG-cstor-target-network-loss/cstor-target-network-loss
    - ./Openshift-EE/pipelines/mongodb/stages/4-chaos/ZFIG-cstor-target-network-loss/cstor-target-network-loss

62F1-jiva-app-kill:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/4-chaos/62F1-jiva-app-kill/jiva-app-kill
    - ./Openshift-EE/pipelines/mongodb/stages/4-chaos/62F1-jiva-app-kill/jiva-app-kill

1ODW-jiva-replica-failure:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/4-chaos/1ODW-jiva-replica-failure/jiva-replica-failure
    - ./Openshift-EE/pipelines/mongodb/stages/4-chaos/1ODW-jiva-replica-failure/jiva-replica-failure

NPAT-jiva-replica-network-delay:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/4-chaos/NPAT-jiva-replica-network-delay/jiva-replica-network-delay
    - ./Openshift-EE/pipelines/mongodb/stages/4-chaos/NPAT-jiva-replica-network-delay/jiva-replica-network-delay

GAFY-jiva-controller-kill:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/4-chaos/GAFY-jiva-controller-kill/jiva-controller-kill
    - ./Openshift-EE/pipelines/mongodb/stages/4-chaos/GAFY-jiva-controller-kill/jiva-controller-kill

CAJ9-jiva-controller-network-delay:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/4-chaos/CAJ9-jiva-controller-network-delay/jiva-controller-network-delay
    - ./Openshift-EE/pipelines/mongodb/stages/4-chaos/CAJ9-jiva-controller-network-delay/jiva-controller-network-delay

XJWF-jiva-replica-node-affinity:
  extends: .chaos_test_template
  script: 
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/4-chaos/XJWF-jiva-replica-node-affinity/jiva-replica-node-affinity
    - ./Openshift-EE/pipelines/mongodb/stages/4-chaos/XJWF-jiva-replica-node-affinity/jiva-replica-node-affinity

NUTL-deprovision-mongodb-cstor:
  image: openebs/openshift-ci:latest
  stage: CLEANUP
  when: always
  script:
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/5-cleanup/NUTL-mongodb-cstor-cleanup/delete-mongodb-cstor
    - ./Openshift-EE/pipelines/mongodb/stages/5-cleanup/NUTL-mongodb-cstor-cleanup/delete-mongodb-cstor
 
RH0D-deprovision-mongodb-jiva:
  image: openebs/openshift-ci:latest
  stage: CLEANUP
  when: always
  script:
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/5-cleanup/RH0D-mongodb-jiva-cleanup/delete-mongodb-jiva
    - ./Openshift-EE/pipelines/mongodb/stages/5-cleanup/RH0D-mongodb-jiva-cleanup/delete-mongodb-jiva
  
L1ZC-cluster-Delete:
  image: openebs/openshift-ci:latest
  stage: CLEANUP
  when: always
  dependencies:
    - 3OLN-OpenShift-3.10
  script:
    - chmod 775 ./Openshift-EE/pipelines/mongodb/stages/5-cleanup/L1ZC-cluster-cleanup/cluster-cleanup
    - ./Openshift-EE/pipelines/mongodb/stages/5-cleanup/L1ZC-cluster-cleanup/cluster-cleanup